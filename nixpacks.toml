[phases.setup]
nixPkgs = ["nodejs-18_x", "openssl", "bash"]
nixpacksVersion = "1.21.0"

[phases.install]
dependsOn = ["setup"]
cmds = [
  "echo '=== Installing backend dependencies ==='",
  "echo 'Current directory:' $(pwd)",
  "ls -la",
  "cd packages/backend && npm install"
]

[phases.build]
dependsOn = ["install"]
cmds = [
  "echo '=== Building backend ==='",
  "cd packages/backend && npx prisma generate && npm run build"
]

[start]
cmd = "cd packages/backend && bash start.sh"
